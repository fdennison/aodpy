import math
import numpy as np

pi = math.pi
rad2deg = 180.0 / pi
deg2rad = pi /180.0

avogadro = 6.022529e+23  # mol^{-1}
M_dryair = 2.8964e-02  # kg/mol
earthrad = 6370.0 #km
gravity = 9.80665  # ms^{-2}, standard value

minsignal=50
maxsignal=65000
mintemp=-10.0
maxtemp=60.0 

acoef = 0.6548
bcoef = 0.574
h2o_k = 0.9156e-2
h2o_e = 0.5918

defaultpressure = 1013.0 #hPa

sd_crit = 0.01

# channels ordered as appear in output files
wavelength = [
 [1020.0, 870.0, 670.0, 440.0, 936.0],
 [1020.0, 870.1, 670.0, 440.0, 870.2, 870.0, 936.0, 870.3],
 [1020.0, 870.0, 670.0, 440.0, 500.0, 936.0, 380.0, 340.0],
 [1020.0, 870.0, 670.0, 440.0, 500.0, 936.0, 778.0, 380.0],
 [1020.0, 1246.0, 870.0, 670.0, 440.0, 500.0, 1021.0, 936.0, 380.0, 340.0],
 [1020.0, 1640.0, 870.0, 670.0, 440.0, 500.0, 1021.0, 936.0, 380.0, 340.0],
 [1020.0, 870.0, 670.0, 440.0, 412.0, 936.0, 500.0, 550.0],
 [1020.0, 870.0, 670.0, 440.0, 412.0, 531.0, 936.0, 500.0, 550.0],
 [1020.0, 1640.0, 870.0, 675.0, 440.0, 500.0, 1021.0, 935.0, 380.0, 340.0],
 [1020.0, 1640.0, 870.0, 675.0, 440.0, 500.0, 1021.0, 935.0, 380.0, 340.0]
]

def wl_index(wl, wl_list):
    # return the index of which is nearest to wl 
    return np.argmin(np.abs(np.array(wl_list) - wl))

ozonecoef = [
 [0.0, 0.0, 0.0462, 0.0041, 0.0],
 [0.0, 0.0, 0.0462, 0.0041, 0.0, 0.0, 0.0, 0.0],
 [0.0, 0.0, 0.0462, 0.0041, 0.0327, 0.0, 0.0002, 0.0447],
 [0.0, 0.0, 0.0462, 0.0041, 0.0322, 0.0, 0.0087, 0.0004],
 [0.0, 0.0, 0.0, 0.0462, 0.0041, 0.0327, 0.0, 0.0, 0.0002, 0.0447],
 [0.0, 0.0, 0.0, 0.0462, 0.0041, 0.0327, 0.0, 0.0, 0.0002, 0.0447],
 [0.0, 0.0, 0.0462, 0.0041, 0.0002, 0.0, 0.0327, 0.0327],
 [0.0, 0.0, 0.0462, 0.0041, 0.0002, 0.0327, 0.0, 0.0327, 0.0327],
 [0.0, 0.0, 0.0, 0.0462, 0.0041, 0.0327, 0.0, 0.0, 0.0002, 0.0447],
 [0.0, 0.0, 0.0, 0.0462, 0.0041, 0.0327, 0.0, 0.0, 0.0002, 0.0447]
]    

